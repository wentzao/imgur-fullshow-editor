<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–‡è—»ç¾èª åœ–ç‰‡å…¬å‘Šç·¨è¼¯å™¨</title>
    <!-- å¼•å…¥Bootstrapå’ŒFont Awesomeçš„CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <!-- å¼•å…¥Sortable.jsç”¨æ–¼æ‹–æ‹½æ’åºåŠŸèƒ½ -->
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.14.0/Sortable.min.js"></script>
    <!-- <link rel=stylesheet type="text/css" href="style.css"> -->
    <style>
        /* å®šç¾©è‡ªå®šç¾©å­—é«” */
        /* @font-face {
            font-family: 'GenSenRounded';
            src: url('GenSenRounded-R.otf') format('opentype');
        } */

        /* å…¨å±€æ¨£å¼è¨­ç½® */
        html,
        body {
            font-family: 'Noto Sans TC', sans-serif;
            padding: 10px;
            background-color: #f8f9fa;
            overflow-y: hidden;
            /* å…¨åŸŸéš±è—å‚ç›´æ»¾å‹•æ¢ */
            height: 100vh;
            margin: 0;
        }

        /* å®¹å™¨æœ€å¤§å¯¬åº¦è¨­ç½® */
        .container {
            max-width: 100%;
        }

        /* åœ–ç‰‡é è¦½æ¨£å¼ */
        .image-preview {
            max-width: 100%;
            max-height: 200px;
            margin-top: 10px;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }

        /* åœ–ç‰‡å®¹å™¨æ¨£å¼ */
        .img-container {
            position: relative;
            border-radius: 15px;
            margin-bottom: 10px;
            cursor: move;
        }

        /* åˆªé™¤æŒ‰éˆ•æ¨£å¼ */
        .delete-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background-color: red;
            color: white;
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            text-align: center;
            line-height: 25px;
            cursor: pointer;
        }

        /* é¡è‰²é è¦½æ¨£å¼ */
        .color-preview {
            width: 30px;
            display: inline-block;
            border: 1px solid #ddd;
            vertical-align: middle;
            margin-left: 10px;
        }

        /* URLé¡¯ç¤ºå€åŸŸæ¨£å¼ */
        .url-display {
            margin-top: 20px;
            padding: 10px;
            background-color: #fff;
            border: 1px solid #ddd;
            overflow-wrap: break-word;
        }

        /* è¤‡è£½æŒ‰éˆ•æ¨£å¼ */
        .copy-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            padding: 10px;
            background-color: #007bff;
            color: white;
            text-align: center;
            cursor: pointer;
        }

        /* ä¸»è‰²å’Œå‰¯è‰²é è¦½æ¨£å¼ */
        #primaryColorPreview {
            background-color: #02a568;
        }

        #secondaryColorPreview {
            background-color: #e6f7f0;
        }

        /* ç·¨è¼¯å™¨å€åŸŸæ¨£å¼ */
        #editorSection {
            width: 100%;
            margin-bottom: 20px;
        }

        /* é è¦½å€åŸŸæ¨£å¼ */
        #previewSection {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            margin-top: 20px;
            height: calc(100vh - 150px);
            overflow: hidden;
        }

        /* è¨­å‚™æ¨¡æ“¬å™¨å®¹å™¨ */
        .device-simulator {
            position: relative;
            background: #333;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        /* æ‰‹æ©Ÿæ¨¡æ“¬å™¨ */
        .device-simulator.mobile {
            width: 390px;
            height: 844px;
            border-radius: 30px;
            padding: 30px 15px;
        }

        /* å¹³æ¿æ¨¡æ“¬å™¨ */
        .device-simulator.tablet {
            width: 820px;
            height: 1180px;
            border-radius: 25px;
            padding: 25px;
        }

        /* æ¡Œæ©Ÿæ¨¡æ“¬å™¨ */
        .device-simulator.desktop {
            width: 1400px;
            height: 900px;
            border-radius: 10px;
            padding: 10px;
            background: #222;
        }

        /* è¨­å‚™è¢å¹• */
        .device-screen {
            width: 100%;
            height: 100%;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }

        .device-screen.mobile {
            border-radius: 20px;
        }

        .device-screen.tablet {
            border-radius: 15px;
        }

        .device-screen.desktop {
            border-radius: 5px;
        }

        /* é è¦½iframeæ¨£å¼ */
        #previewIframe {
            width: 100%;
            height: 100%;
            border: none;
            display: block;
        }

        /* è¨­å‚™æ¨™ç±¤ */
        .device-label {
            position: absolute;
            top: -40px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
        }

        /* ç¸®æ”¾å®¹å™¨ä»¥é©æ‡‰è¦–çª— */
        .preview-container {
            transform-origin: top center;
            transition: transform 0.3s ease;
        }

        /* åœ–ç‰‡åˆ—è¡¨æ¨£å¼ */
        #imageList {
            min-height: 50px;
        }


        /* éš±è—æ‰€æœ‰æ»¾å‹•æ¢ä½†ä¿ç•™æ»¾å‹•åŠŸèƒ½ */
        html,
        body,
        .col-scrollable {
            scrollbar-width: none;
            /* Firefox */
            -ms-overflow-style: none;
            /* IE and Edge */
        }

        /* Webkit browsers (Chrome, Safari, Edge) */
        ::-webkit-scrollbar {
            display: none;
            width: 0;
            height: 0;
        }

        .col-scrollable {
            height: 100vh;
            /* è¨­å®šé«˜åº¦ç‚ºè¦–çª—çš„100% */
            overflow-y: auto;
            /* å…§å®¹è¶…å‡ºæ™‚é¡¯ç¤ºæ»¾å‹•æ¢ */
            padding-bottom: 100px;
            /* åº•éƒ¨ç•™ç™½é¿å…å…§å®¹è¢«æ“‹ä½ */
        }

        /* Range æ»‘æ¡¿æ¨£å¼ - è¦†è“‹ Bootstrap é è¨­ */
        .form-range,
        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 8px;
            background: #dee2e6 !important;
            border-radius: 4px;
            outline: none;
            padding: 0 !important;
            margin: 10px 0;
        }

        /* Range æ»‘æ¡¿ - æ»‘å¡Š (Webkit: Chrome, Safari, Edge) */
        .form-range::-webkit-slider-thumb,
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #0d6efd;
            border-radius: 50%;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            margin-top: -6px;
        }

        .form-range::-webkit-slider-thumb:hover,
        input[type="range"]::-webkit-slider-thumb:hover {
            background: #0b5ed7;
        }

        /* Range æ»‘æ¡¿ - è»Œé“ (Webkit) */
        .form-range::-webkit-slider-runnable-track,
        input[type="range"]::-webkit-slider-runnable-track {
            height: 8px;
            background: #dee2e6;
            border-radius: 4px;
        }

        /* Range æ»‘æ¡¿ - æ»‘å¡Š (Firefox) */
        .form-range::-moz-range-thumb,
        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: #0d6efd;
            border-radius: 50%;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        /* Range æ»‘æ¡¿ - è»Œé“ (Firefox) */
        .form-range::-moz-range-track,
        input[type="range"]::-moz-range-track {
            background: #dee2e6;
            height: 8px;
            border-radius: 4px;
        }


        .col-scrollable {
            height: 100vh;
            /* è¨­å®šé«˜åº¦ç‚ºè¦–çª—çš„100% */
            overflow-y: auto;
            /* å…§å®¹è¶…å‡ºæ™‚é¡¯ç¤ºæ»¾å‹•æ¢ */
            padding-bottom: 100px;
            /* åº•éƒ¨ç•™ç™½é¿å…å…§å®¹è¢«æ“‹ä½ */
        }

        .col-scrollable.right-column {
            overflow: hidden;
            /* å³å´æ¬„ä½éš±è—æ»¾å‹•æ¢ */
        }

        /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
        @media (max-width: 767px) {
            .container {
                max-width: 100%;
            }

            .copy-btn {
                width: 15%;
            }
        }

        @media (min-width: 768px) {
            .copy-btn {
                width: 8%;
                margin-left: auto;
            }
        }
    </style>
</head>

<body>
    <!-- ä¸»è¦å…§å®¹å€åŸŸ -->
    <div class="row" style="height: 100vh; margin: 0;">
        <!-- ç·¨è¼¯å™¨å€åŸŸ -->
        <div id="left-column" class="col-lg-4 col-12 col-scrollable" style="overflow: auto;">
            <div id="editorSection" class="container">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2>åœ–ç‰‡å…¬å‘Šç·¨è¼¯å™¨ <i class="fas fa-history" data-bs-toggle="modal" data-bs-target="#decodeModal"></i></h2>
                </div>
                <!-- æ¨™é¡Œå’Œæ—¥æœŸè¼¸å…¥å€ -->
                <div class="row mb-3">
                    <div class="col-lg-6 mb-3">
                        <label for="title" class="form-label">æ¨™é¡Œ</label>
                        <input type="text" class="form-control form-control" id="title">
                    </div>
                    <div class="col-lg-6">
                        <label for="date" class="form-label">æ—¥æœŸ</label>
                        <input type="date" class="form-control form-control" id="date" value="">
                    </div>
                </div>
                <!-- é¡è‰²å’Œæ’åˆ—é¸æ“‡å€ -->
                <div class="row mb-3">
                    <div class="col-lg-4 mb-3">
                        <label for="primaryColor" class="form-label">ä¸»é¡è‰²</label>
                        <div class="input-group">
                            <input type="text" class="form-control form-control" id="primaryColor"
                                placeholder="#02a568">
                            <div id="primaryColorPreview" class="color-preview"></div>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <label for="secondaryColor" class="form-label">å‰¯é¡è‰²</label>
                        <div class="input-group">
                            <input type="text" class="form-control form-control" id="secondaryColor"
                                placeholder="#e6f7f0">
                            <div id="secondaryColorPreview" class="color-preview"></div>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <label for="imageCount" class="form-label">æ¡Œæ©Ÿæ’åˆ—</label>
                        <select class="form-control form-control" id="imageCount">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3" selected>3</option>
                            <option value="4">4</option>
                        </select>
                    </div>
                </div>
                <!-- åœ–ç‰‡ä¸Šå‚³å€ -->
                <div class="row mb-3">
                    <div class="col-lg">
                        <label for="upload" class="form-label">ä¸Šå‚³åœ–ç‰‡ï¼ˆå¯å¤šé¸ï¼‰</label>
                        <input type="file" class="form-control form-control" id="upload" accept="image/*" multiple>

                        <!-- åœ–ç‰‡ç¶²å€è¼¸å…¥å€ -->
                        <div class="mt-3">
                            <label for="imageUrl" class="form-label">æˆ–ç›´æ¥è²¼ä¸Šåœ–ç‰‡ç¶²å€</label>
                            <div class="input-group">
                                <input type="url" class="form-control" id="imageUrl"
                                    placeholder="https://example.com/image.jpg">
                                <button type="button" class="btn btn-primary" onclick="addImageFromUrl()">
                                    <i class="fas fa-plus"></i> æ–°å¢
                                </button>
                            </div>
                        </div>

                        <div id="imageList" class="row mt-3"></div>
                    </div>
                </div>

                <!-- ========== é¡¯ç¤ºé¸é … ========== -->
                <hr class="my-4">
                <h5>ğŸ“‹ é¡¯ç¤ºé¸é …</h5>
                <div class="row mb-3">
                    <div class="col-lg-6">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="showTitle" checked>
                            <label class="form-check-label" for="showTitle">é¡¯ç¤ºæ¨™é¡Œå’Œæ—¥æœŸ</label>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="showFooter" checked>
                            <label class="form-check-label" for="showFooter">é¡¯ç¤ºåº•éƒ¨ Footer</label>
                        </div>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-lg-12">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="imageRounded" checked>
                            <label class="form-check-label" for="imageRounded">åœ–ç‰‡åœ“è§’</label>
                        </div>
                    </div>
                </div>

                <!-- ========== è¢å¹•é‚Šç•Œèª¿æ•´ ========== -->
                <hr class="my-4">
                <h5>ğŸ–¼ï¸ è¢å¹•é‚Šç•Œ</h5>
                <div class="row mb-3">
                    <div class="col-lg-6">
                        <label for="screenPaddingVertical" class="form-label">
                            ä¸Šä¸‹é‚Šç•Œï¼š<span id="screenPaddingVerticalValue">10</span>px
                        </label>
                        <input type="range" class="form-range" id="screenPaddingVertical" min="0" max="100" value="10">
                    </div>
                    <div class="col-lg-6">
                        <label for="screenPaddingHorizontal" class="form-label">
                            å·¦å³é‚Šç•Œï¼š<span id="screenPaddingHorizontalValue">10</span>px
                        </label>
                        <input type="range" class="form-range" id="screenPaddingHorizontal" min="0" max="100"
                            value="10">
                    </div>
                </div>

                <!-- ========== èƒŒæ™¯è¨­å®š ========== -->
                <hr class="my-4">
                <h5>ğŸ¨ èƒŒæ™¯è¨­å®š</h5>
                <div class="row mb-3">
                    <div class="col-lg-12">
                        <div class="btn-group w-100" role="group">
                            <input type="radio" class="btn-check" name="bgType" id="bgDots" value="dots" checked>
                            <label class="btn btn-outline-secondary" for="bgDots">é»é»èƒŒæ™¯</label>

                            <input type="radio" class="btn-check" name="bgType" id="bgColor" value="color">
                            <label class="btn btn-outline-secondary" for="bgColor">ç´”è‰²</label>

                            <input type="radio" class="btn-check" name="bgType" id="bgImage" value="image">
                            <label class="btn btn-outline-secondary" for="bgImage">è‡ªè¨‚åœ–ç‰‡</label>
                        </div>
                    </div>
                    <!-- ç´”è‰²é¸æ“‡å™¨ï¼ˆæ¢ä»¶é¡¯ç¤ºï¼‰-->
                    <div class="col-lg-6 mt-2" id="bgColorPicker" style="display:none;">
                        <label class="form-label">èƒŒæ™¯é¡è‰²</label>
                        <div class="input-group">
                            <input type="text" class="form-control" id="bgColorValue" placeholder="#FFFFFF">
                            <div id="bgColorPreview" class="color-preview" style="background-color: #FFFFFF;"></div>
                        </div>
                    </div>
                    <!-- èƒŒæ™¯åœ–ç‰‡ä¸Šå‚³ï¼ˆæ¢ä»¶é¡¯ç¤ºï¼‰-->
                    <div class="col-lg-12 mt-2" id="bgImageUpload" style="display:none;">
                        <label class="form-label">èƒŒæ™¯åœ–ç‰‡</label>
                        <input type="file" class="form-control" id="bgImageFile" accept="image/*">
                        <input type="url" class="form-control mt-2" id="bgImageUrl" placeholder="æˆ–è²¼ä¸Šåœ–ç‰‡ç¶²å€">
                    </div>
                </div>

                <!-- ========== åœ–ç‰‡é–“è·èª¿æ•´ ========== -->
                <hr class="my-4">
                <h5>ğŸ–¼ï¸ åœ–ç‰‡é–“è·</h5>
                <div class="row mb-3">
                    <div class="col-lg-6">
                        <label for="imageGapVertical" class="form-label">
                            ä¸Šä¸‹é–“è·ï¼š<span id="imageGapVerticalValue">10</span>px
                        </label>
                        <input type="range" class="form-range" id="imageGapVertical" min="0" max="50" value="10">
                    </div>
                    <div class="col-lg-6">
                        <label for="imageGapHorizontal" class="form-label">
                            å·¦å³é–“è·ï¼š<span id="imageGapHorizontalValue">10</span>px
                        </label>
                        <input type="range" class="form-range" id="imageGapHorizontal" min="0" max="50" value="10">
                    </div>
                </div>
                <!-- URLé¡¯ç¤ºå€ -->
                <div class="row mb-3" hidden>
                    <div class="col-lg-6">
                        <label for="url" class="form-label">å…¬å‘Šç¶²å€</label>
                        <div class="input-group mb-3">
                            <input type="text" class="form-control form-control" id="url" readonly>
                            <button type="button" class="copy-btn btn btn-primary" onclick="copyToClipboard()">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <label for="lineurl" class="form-label">LINEåœ–æ–‡ç¶²å€</label>
                        <div class="input-group mb-3">
                            <input type="text" class="form-control form-control" id="lineurl" readonly>
                            <button type="button" class="copy-btn btn btn-primary" onclick="copyToClipboard2()">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <!-- è§£ç¢¼ Modal -->
                <div class="modal fade" id="decodeModal" tabindex="-1" aria-labelledby="decodeModalLabel"
                    aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="decodeModalLabel">ç·¨è¼¯æ­·å²ç´€éŒ„</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <input type="text" id="decodedUrlInput" class="form-control" placeholder="è²¼ä¸Šé€£çµ">
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-primary" onclick="decodeAndApplyData()">ç¢ºèª</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- é è¦½å€åŸŸ -->
        <div id="right-column" class="col-lg-8 col-12 col-scrollable right-column">
            <div class="container">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <!-- å·¦å´å…ƒç´  -->
                    <div class="d-flex align-items-center">
                        <h2>å…¬å‘Šç¶²é é è¦½</h2>
                        <select class="form-control form-control" id="scale"
                            style="width: auto; display: inline-block; margin-left: 20px;">
                            <option value="0.5">æ¡Œæ©Ÿ</option>
                            <option value="0.75">å¹³æ¿</option>
                            <option value="1" selected>æ‰‹æ©Ÿ</option>
                        </select>
                    </div>
                    <!-- å³å´æŒ‰éˆ• -->
                    <div class="d-flex align-items-center">
                        <button class="btn btn-outline-success" style="margin-left: 8px;" onclick="copyToClipboard()"><i
                                class="far fa-copy"></i>å…¬å‘Šç¶²å€</button>
                        <button class="btn btn-outline-success" style="margin-left: 8px;"
                            onclick="copyToClipboard2()"><i class="far fa-copy"></i>Lineç¶²å€</button>
                    </div>
                </div>
                <div id="previewSection">
                    <div class="preview-container" id="previewContainer">
                        <div class="device-simulator mobile" id="deviceSimulator">
                            <div class="device-label" id="deviceLabel">iPhone 14 Pro (390Ã—844)</div>
                            <div class="device-screen mobile" id="deviceScreen">
                                <iframe id="previewIframe"></iframe>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <!-- å¼•å…¥lz-stringåº«ç”¨æ–¼URLå£“ç¸® -->
    <script src="https://cdn.jsdelivr.net/npm/lz-string@1.4.4/libs/lz-string.min.js"></script>
    <script>
        // ç•¶DOMå®Œå…¨åŠ è¼‰å¾ŒåŸ·è¡Œ
        document.addEventListener('DOMContentLoaded', function () {
            // è¨­ç½®æ—¥æœŸè¼¸å…¥æ¡†çš„åˆå§‹å€¼ç‚ºä»Šå¤©
            document.getElementById('date').value = new Date().toISOString().slice(0, 10);

            // ç‚ºåœ–ç‰‡ä¸Šå‚³inputæ·»åŠ äº‹ä»¶ç›£è½å™¨
            document.getElementById('upload').addEventListener('change', function (event) {
                const files = event.target.files;
                if (files.length > 0) {
                    Array.from(files).forEach(file => {
                        uploadImageToImgur(file);
                    });
                }
            });

            // ç‚ºå„å€‹è¼¸å…¥å…ƒç´ æ·»åŠ äº‹ä»¶ç›£è½å™¨ï¼Œç•¶å€¼è®ŠåŒ–æ™‚æ›´æ–°URL
            document.getElementById('title').addEventListener('input', updateUrl);
            document.getElementById('date').addEventListener('input', updateUrl);
            document.getElementById('primaryColor').addEventListener('input', updatePrimaryColor);
            document.getElementById('secondaryColor').addEventListener('input', updateSecondaryColor);
            document.getElementById('imageCount').addEventListener('input', updateUrl);
            document.getElementById('scale').addEventListener('input', updateScale);

            // ç‚ºåœ–ç‰‡ç¶²å€è¼¸å…¥æ¡†æ·»åŠ  Enter éµæ”¯æ´
            document.getElementById('imageUrl').addEventListener('keypress', function (event) {
                if (event.key === 'Enter') {
                    event.preventDefault();
                    addImageFromUrl();
                }
            });

            // åˆå§‹åŒ–é¡è‰²é è¦½
            updatePrimaryColor();
            updateSecondaryColor();

            // åˆå§‹åŒ–Sortable.jsï¼Œä½¿åœ–ç‰‡åˆ—è¡¨å¯æ‹–æ‹½æ’åº
            new Sortable(document.getElementById('imageList'), {
                animation: 150,
                ghostClass: 'blue-background-class',
                onEnd: function () {
                    updateImageOrder();
                }
            });

            // æ–°å¢ï¼šåœ–ç‰‡åœ“è§’äº‹ä»¶ç›£è½å™¨
            document.getElementById('imageRounded').addEventListener('change', updateUrl);

            // æ–°å¢ï¼šé¡¯ç¤ºé¸é …äº‹ä»¶ç›£è½å™¨
            document.getElementById('showTitle').addEventListener('change', updateUrl);
            document.getElementById('showFooter').addEventListener('change', updateUrl);

            // æ–°å¢ï¼šè¢å¹•é‚Šç•Œæ»‘æ¡¿äº‹ä»¶ç›£è½å™¨
            document.getElementById('screenPaddingVertical').addEventListener('input', function () {
                document.getElementById('screenPaddingVerticalValue').textContent = this.value;
                updateUrl();
            });
            document.getElementById('screenPaddingHorizontal').addEventListener('input', function () {
                document.getElementById('screenPaddingHorizontalValue').textContent = this.value;
                updateUrl();
            });

            // æ–°å¢ï¼šåœ–ç‰‡é–“è·æ»‘æ¡¿äº‹ä»¶ç›£è¯å™¨
            document.getElementById('imageGapVertical').addEventListener('input', function () {
                document.getElementById('imageGapVerticalValue').textContent = this.value;
                updateUrl();
            });
            document.getElementById('imageGapHorizontal').addEventListener('input', function () {
                document.getElementById('imageGapHorizontalValue').textContent = this.value;
                updateUrl();
            });

            // æ–°å¢ï¼šèƒŒæ™¯é¡å‹åˆ‡æ›äº‹ä»¶ç›£è½å™¨
            document.querySelectorAll('input[name="bgType"]').forEach(radio => {
                radio.addEventListener('change', function () {
                    updateBgTypeUI();
                    updateUrl();
                });
            });

            // æ–°å¢ï¼šèƒŒæ™¯é¡è‰²è¼¸å…¥äº‹ä»¶ç›£è½å™¨
            document.getElementById('bgColorValue').addEventListener('input', function () {
                let color = this.value;
                if (color && !color.startsWith('#')) {
                    color = '#' + color;
                    this.value = color;
                }
                document.getElementById('bgColorPreview').style.backgroundColor = color;
                updateUrl();
            });

            // æ–°å¢ï¼šèƒŒæ™¯åœ–ç‰‡ç¶²å€äº‹ä»¶ç›£è½å™¨
            document.getElementById('bgImageUrl').addEventListener('input', updateUrl);

            // æ–°å¢ï¼šèƒŒæ™¯åœ–ç‰‡ä¸Šå‚³äº‹ä»¶ç›£è½å™¨
            document.getElementById('bgImageFile').addEventListener('change', function (event) {
                const file = event.target.files[0];
                if (file) {
                    uploadBgImageToImgur(file);
                }
            });

            updateScale();
        });

        // å­˜å„²ä¸Šå‚³åœ–ç‰‡çš„ID
        let imageIds = [];

        // ä¸Šå‚³åœ–ç‰‡åˆ°Imgur (é€é Cloudflare Worker ä»£ç†)
        function uploadImageToImgur(file) {
            // å‰µå»ºä¸¦é¡¯ç¤ºä¸Šå‚³ç‹€æ…‹å…ƒç´ 
            const saveStatus = document.createElement('div');
            saveStatus.classList.add('saveStatus');
            saveStatus.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ä¸Šå‚³ä¸­...';
            document.getElementById('imageList').appendChild(saveStatus);

            // Imgur APIå®¢æˆ¶ç«¯ID
            const clientId = "a0a92307b538c2f";

            // å°‡åœ–ç‰‡è½‰æ›ç‚º Base64
            fileToBase64(file)
                .then((base64) => {
                    return fetch("https://imgurproxy.dreamdomroy.workers.dev/", {
                        method: "POST",
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            image: base64,
                            clientId: clientId
                        }),
                        muteHttpExceptions: true,
                    });
                })
                .then(response => response.json())
                .then(result => {
                    if (result.success) {
                        // å¦‚æœä¸Šå‚³æˆåŠŸï¼Œæ·»åŠ åœ–ç‰‡IDåˆ°æ•¸çµ„
                        imageIds.push(result.data.id);
                        // å‰µå»ºåœ–ç‰‡é è¦½å…ƒç´ 
                        const imgContainer = document.createElement('div');
                        imgContainer.classList.add('img-container', 'col-12', 'col-lg-4', 'col-md-6');
                        imgContainer.dataset.imageId = result.data.id;
                        const img = document.createElement('img');
                        img.src = result.data.link;
                        img.classList.add('image-preview');
                        // å‰µå»ºåˆªé™¤æŒ‰éˆ•
                        const deleteBtn = document.createElement('button');
                        deleteBtn.classList.add('delete-btn');
                        deleteBtn.innerHTML = '&times;';
                        deleteBtn.onclick = () => {
                            const index = imageIds.indexOf(result.data.id);
                            if (index > -1) {
                                imageIds.splice(index, 1);
                            }
                            imgContainer.remove();
                            updateUrl();
                        };
                        imgContainer.appendChild(img);
                        imgContainer.appendChild(deleteBtn);
                        document.getElementById('imageList').appendChild(imgContainer);
                    } else {
                        alert("åœ–ç‰‡ä¸Šå‚³å¤±æ•—ï¼Œè«‹é‡è©¦ï¼éŒ¯èª¤: " + (result.error || "æœªçŸ¥éŒ¯èª¤"));
                    }
                    saveStatus.remove();
                    updateUrl();
                    updateScale();
                })
                .catch(error => {
                    console.error("Error:", error);
                    saveStatus.innerHTML = "ä¸Šå‚³å¤±æ•—: " + error.message;
                })
                .finally(() => {
                    updateScale();
                });
        }

        // å°‡æª”æ¡ˆè½‰æ›ç‚º Base64
        function fileToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => {
                    // ç§»é™¤ data:image/jpeg;base64, å‰ç¶´ï¼Œåªä¿ç•™ base64 å­—ç¬¦ä¸²
                    const base64 = reader.result.split(',')[1];
                    resolve(base64);
                };
                reader.onerror = error => reject(error);
            });
        }

        // å¾åœ–ç‰‡ç¶²å€æ–°å¢åœ–ç‰‡
        function addImageFromUrl() {
            const urlInput = document.getElementById('imageUrl');
            const imageUrl = urlInput.value.trim();

            // é©—è­‰ç¶²å€
            if (!imageUrl) {
                alert('è«‹è¼¸å…¥åœ–ç‰‡ç¶²å€');
                return;
            }

            // ç°¡å–®çš„URLæ ¼å¼é©—è­‰
            try {
                new URL(imageUrl);
            } catch (e) {
                alert('è«‹è¼¸å…¥æœ‰æ•ˆçš„ç¶²å€æ ¼å¼');
                return;
            }

            // é©—è­‰æ˜¯å¦ç‚ºåœ–ç‰‡ç¶²å€
            if (!isImageUrl(imageUrl)) {
                alert('è«‹è¼¸å…¥æœ‰æ•ˆçš„åœ–ç‰‡ç¶²å€ï¼ˆæ”¯æ´ .jpg, .jpeg, .png, .gif, .webp, .bmp, .svgï¼‰');
                return;
            }

            // å‰µå»ºä¸¦é¡¯ç¤ºè¼‰å…¥ç‹€æ…‹
            const saveStatus = document.createElement('div');
            saveStatus.classList.add('saveStatus');
            saveStatus.innerHTML = '<i class="fas fa-spinner fa-spin"></i> è¼‰å…¥åœ–ç‰‡ä¸­...';
            document.getElementById('imageList').appendChild(saveStatus);

            // æ¸¬è©¦åœ–ç‰‡æ˜¯å¦å¯ä»¥è¼‰å…¥
            const testImg = new Image();
            testImg.crossOrigin = "anonymous";

            testImg.onload = function () {
                // åœ–ç‰‡è¼‰å…¥æˆåŠŸï¼Œæ–°å¢åˆ°åˆ—è¡¨
                const imgContainer = document.createElement('div');
                imgContainer.classList.add('img-container', 'col-12', 'col-lg-4', 'col-md-6');
                imgContainer.dataset.imageId = imageUrl; // ç›´æ¥ä½¿ç”¨å®Œæ•´URLä½œç‚ºID

                const img = document.createElement('img');
                img.src = imageUrl;
                img.classList.add('image-preview');

                // å‰µå»ºåˆªé™¤æŒ‰éˆ•
                const deleteBtn = document.createElement('button');
                deleteBtn.classList.add('delete-btn');
                deleteBtn.innerHTML = '&times;';
                deleteBtn.onclick = () => {
                    const index = imageIds.indexOf(imageUrl);
                    if (index > -1) {
                        imageIds.splice(index, 1);
                    }
                    imgContainer.remove();
                    updateUrl();
                };

                imgContainer.appendChild(img);
                imgContainer.appendChild(deleteBtn);
                document.getElementById('imageList').appendChild(imgContainer);

                // æ–°å¢åˆ°åœ–ç‰‡IDé™£åˆ—ï¼ˆç¾åœ¨æ”¯æ´å®Œæ•´URLï¼‰
                imageIds.push(imageUrl);

                // æ¸…ç©ºè¼¸å…¥æ¡†
                urlInput.value = '';

                // ç§»é™¤è¼‰å…¥ç‹€æ…‹ä¸¦æ›´æ–°
                saveStatus.remove();
                updateUrl();
                updateScale();
            };

            testImg.onerror = function () {
                // åœ–ç‰‡è¼‰å…¥å¤±æ•—
                alert('ç„¡æ³•è¼‰å…¥æ­¤åœ–ç‰‡ï¼Œè«‹æª¢æŸ¥ç¶²å€æ˜¯å¦æ­£ç¢º');
                saveStatus.remove();
            };

            // é–‹å§‹è¼‰å…¥åœ–ç‰‡
            testImg.src = imageUrl;
        }

        // é©—è­‰æ˜¯å¦ç‚ºåœ–ç‰‡ç¶²å€
        function isImageUrl(url) {
            const imageExtensions = ['.jpg', '.jpeg', '.png', '.gif', '.webp', '.bmp', '.svg'];
            const lowerUrl = url.toLowerCase();
            return imageExtensions.some(ext => lowerUrl.includes(ext)) ||
                lowerUrl.includes('imgur.com') ||
                lowerUrl.includes('i.imgur.com');
        }

        // æ›´æ–°åœ–ç‰‡é †åº
        function updateImageOrder() {
            imageIds = Array.from(document.getElementById('imageList').children)
                .map(container => container.dataset.imageId);
            updateUrl();
        }

        // æ›´æ–°ä¸»é¡è‰²
        function updatePrimaryColor() {
            const primaryColorInput = document.getElementById('primaryColor');
            let primaryColor = primaryColorInput.value;
            if (primaryColor && !primaryColor.startsWith('#')) {
                primaryColor = '#' + primaryColor;
            }
            document.getElementById('primaryColorPreview').style.backgroundColor = primaryColor;
            primaryColorInput.value = primaryColor;
            updateUrl();
        }

        // æ›´æ–°å‰¯é¡è‰²
        function updateSecondaryColor() {
            const secondaryColorInput = document.getElementById('secondaryColor');
            let secondaryColor = secondaryColorInput.value;
            if (secondaryColor && !secondaryColor.startsWith('#')) {
                secondaryColor = '#' + secondaryColor;
            }
            document.getElementById('secondaryColorPreview').style.backgroundColor = secondaryColor;
            secondaryColorInput.value = secondaryColor;
            updateUrl();
        }

        // æ›´æ–°URL
        function updateUrl() {
            const title = document.getElementById('title').value;
            const date = document.getElementById('date').value.replace(/-/g, '');
            const primaryColor = document.getElementById('primaryColor').value || '#02a568';
            const secondaryColor = document.getElementById('secondaryColor').value || '#e6f7f0';
            const imageCount = document.getElementById('imageCount').value;

            // æ–°å¢ï¼šç²å–æ–°æ§åˆ¶é …çš„å€¼
            const showTitle = document.getElementById('showTitle').checked;
            const showFooter = document.getElementById('showFooter').checked;
            const imageRounded = document.getElementById('imageRounded').checked;
            const screenPaddingV = document.getElementById('screenPaddingVertical').value;
            const screenPaddingH = document.getElementById('screenPaddingHorizontal').value;
            const bgType = document.querySelector('input[name="bgType"]:checked').value;
            const bgColorValue = document.getElementById('bgColorValue').value;
            const bgImageUrl = document.getElementById('bgImageUrl').value;
            const imageGapV = document.getElementById('imageGapVertical').value;
            const imageGapH = document.getElementById('imageGapHorizontal').value;

            // æ§‹å»ºURLåƒæ•¸
            let url = `title=${encodeURIComponent(title)}&date=${date}&primaryColor=${encodeURIComponent(primaryColor)}&secondaryColor=${encodeURIComponent(secondaryColor)}&imageCount=${imageCount}`;

            // æ–°å¢ï¼šæ·»åŠ æ–°åƒæ•¸ï¼ˆåªæœ‰éé è¨­å€¼æ‰åŠ å…¥ä»¥ç¯€çœURLé•·åº¦ï¼‰
            if (!showTitle) url += `&st=0`;
            if (!showFooter) url += `&sf=0`;
            if (!imageRounded) url += `&br=0`; // br=1 æ˜¯é è¨­ï¼Œæ‰€ä»¥ br=0 æ‰åŠ 
            if (screenPaddingV !== '10') url += `&spv=${screenPaddingV}`;
            if (screenPaddingH !== '10') url += `&sph=${screenPaddingH}`;
            if (bgType !== 'dots') {
                url += `&bt=${bgType}`;
                if (bgType === 'color' && bgColorValue) {
                    url += `&bc=${encodeURIComponent(bgColorValue)}`;
                } else if (bgType === 'image' && bgImageUrl) {
                    url += `&bi=${encodeURIComponent(bgImageUrl)}`;
                }
            }
            if (imageGapV !== '10') url += `&igv=${imageGapV}`;
            if (imageGapH !== '10') url += `&igh=${imageGapH}`;

            if (imageIds.length > 0) {
                // è™•ç†æ··åˆçš„åœ–ç‰‡ä¾†æºï¼šImgur ID å’Œå®Œæ•´ URL
                const encodedImageIds = imageIds.map(id => {
                    // å¦‚æœæ˜¯å®Œæ•´ URLï¼ˆä»¥ http é–‹é ­ï¼‰ï¼Œå‰‡é€²è¡Œç·¨ç¢¼
                    if (id.startsWith('http')) {
                        return encodeURIComponent(id);
                    }
                    // å¦‚æœæ˜¯ Imgur IDï¼Œä¿æŒåŸæ¨£
                    return id;
                });
                url += `&id=${encodedImageIds.join(',')}`;
            }
            // å£“ç¸®URL
            const compressedUrl = LZString.compressToEncodedURIComponent(url);
            // æ›´æ–°URLé¡¯ç¤º
            document.getElementById('url').value = `https://news.wentzao.com/?data=${compressedUrl}`;
            document.getElementById('lineurl').value = `https://liff.line.me/1660786685-j636WZpM?data=${compressedUrl}`;
            updatePreview();
        }

        // æ›´æ–°é è¦½
        function updatePreview() {
            const previewIframe = document.getElementById('previewIframe');
            const previewUrl = document.getElementById('url').value;

            // åªæœ‰ç•¶URLç™¼ç”Ÿè®ŠåŒ–æ™‚æ‰æ›´æ–°iframeçš„src
            if (previewIframe.src !== previewUrl) {
                previewIframe.src = previewUrl;
            }
        }

        // æ›´æ–°é è¦½ç¸®æ”¾æ¯”ä¾‹
        function updateScale() {
            const scale = document.getElementById('scale').value;
            const deviceSimulator = document.getElementById('deviceSimulator');
            const deviceScreen = document.getElementById('deviceScreen');
            const deviceLabel = document.getElementById('deviceLabel');
            const previewContainer = document.getElementById('previewContainer');

            // ç§»é™¤æ‰€æœ‰è¨­å‚™é¡åˆ¥
            deviceSimulator.className = 'device-simulator';
            deviceScreen.className = 'device-screen';

            let containerScale = 1;

            if (scale === '1') {
                // æ‰‹æ©Ÿæ¨¡æ“¬å™¨
                deviceSimulator.classList.add('mobile');
                deviceScreen.classList.add('mobile');
                deviceLabel.textContent = 'iPhone 14 Pro (390Ã—844)';
                containerScale = 0.6; // ç¸®å°ä»¥é©æ‡‰è¦–çª—
            } else if (scale === '0.75') {
                // å¹³æ¿æ¨¡æ“¬å™¨
                deviceSimulator.classList.add('tablet');
                deviceScreen.classList.add('tablet');
                deviceLabel.textContent = 'iPad Pro (820Ã—1180)';
                containerScale = 0.4; // ç¸®å°ä»¥é©æ‡‰è¦–çª—
            } else {
                // æ¡Œæ©Ÿæ¨¡æ“¬å™¨
                deviceSimulator.classList.add('desktop');
                deviceScreen.classList.add('desktop');
                deviceLabel.textContent = 'Desktop (1400Ã—900)';
                containerScale = 0.45; // ç¸®å°ä»¥é©æ‡‰è¦–çª—
            }

            // æ‡‰ç”¨å®¹å™¨ç¸®æ”¾
            previewContainer.style.transform = `scale(${containerScale})`;

            updatePreview();
        }

        // æ–°å¢ï¼šæ›´æ–°èƒŒæ™¯é¡å‹UIé¡¯ç¤º
        function updateBgTypeUI() {
            const bgType = document.querySelector('input[name="bgType"]:checked').value;
            const bgColorPicker = document.getElementById('bgColorPicker');
            const bgImageUpload = document.getElementById('bgImageUpload');

            // éš±è—æ‰€æœ‰æ¢ä»¶é¡¯ç¤ºå€å¡Š
            bgColorPicker.style.display = 'none';
            bgImageUpload.style.display = 'none';

            // æ ¹æ“šé¸æ“‡é¡¯ç¤ºå°æ‡‰å€å¡Š
            if (bgType === 'color') {
                bgColorPicker.style.display = 'block';
            } else if (bgType === 'image') {
                bgImageUpload.style.display = 'block';
            }
        }

        // æ–°å¢ï¼šä¸Šå‚³èƒŒæ™¯åœ–ç‰‡åˆ°Imgur
        function uploadBgImageToImgur(file) {
            const clientId = "a0a92307b538c2f";
            const bgImageUrlInput = document.getElementById('bgImageUrl');

            // é¡¯ç¤ºä¸Šå‚³ä¸­ç‹€æ…‹
            bgImageUrlInput.value = 'ä¸Šå‚³ä¸­...';
            bgImageUrlInput.disabled = true;

            fileToBase64(file)
                .then((base64) => {
                    return fetch("https://imgurproxy.dreamdomroy.workers.dev/", {
                        method: "POST",
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            image: base64,
                            clientId: clientId
                        }),
                        muteHttpExceptions: true,
                    });
                })
                .then(response => response.json())
                .then(result => {
                    if (result.success) {
                        bgImageUrlInput.value = result.data.link;
                        updateUrl();
                    } else {
                        alert("èƒŒæ™¯åœ–ç‰‡ä¸Šå‚³å¤±æ•—ï¼Œè«‹é‡è©¦ï¼");
                        bgImageUrlInput.value = '';
                    }
                })
                .catch(error => {
                    console.error("Error:", error);
                    bgImageUrlInput.value = '';
                    alert("ä¸Šå‚³å¤±æ•—: " + error.message);
                })
                .finally(() => {
                    bgImageUrlInput.disabled = false;
                });
        }

        // è¤‡è£½å…¬å‘Šç¶²å€åˆ°å‰ªè²¼æ¿
        function copyToClipboard() {
            const url = document.getElementById('url').value;
            navigator.clipboard.writeText(url).then(() => {
                alert('ç¶²å€å·²è¤‡è£½ï¼');
            });
        }

        // è¤‡è£½LINEåœ–æ–‡ç¶²å€åˆ°å‰ªè²¼æ¿
        function copyToClipboard2() {
            const url = document.getElementById('lineurl').value;
            navigator.clipboard.writeText(url).then(() => {
                alert('ç¶²å€å·²è¤‡è£½ï¼');
            });
        }

        function formatDateString(dateString) {
            if (!dateString) return ''; // è™•ç† null/undefined æƒ…æ³
            if (dateString.length === 8) {
                return dateString.slice(0, 4) + '-' + dateString.slice(4, 6) + '-' + dateString.slice(6, 8);
            }
            return dateString;
        }

        // è§£ç¢¼ä¸¦æ‡‰ç”¨æ•¸æ“š
        function decodeAndApplyData() {
            const input = document.getElementById('decodedUrlInput');
            const data = LZString.decompressFromEncodedURIComponent(input.value.split('?data=')[1]);
            const params = new URLSearchParams(data);

            // æ›´æ–°é é¢å…ƒç´ ï¼ˆå¸¶ null æª¢æŸ¥ï¼‰
            document.getElementById('title').value = params.get('title') || '';
            document.getElementById('date').value = formatDateString(params.get('date'));
            document.getElementById('primaryColor').value = params.get('primaryColor') || '#02a568';
            document.getElementById('secondaryColor').value = params.get('secondaryColor') || '#e6f7f0';
            document.getElementById('imageCount').value = params.get('imageCount') || '1';

            // æ›´æ–°æ–°å¢çš„åƒæ•¸ï¼ˆå‘ä¸‹ç›¸å®¹ï¼šèˆŠçš„ URL å¯èƒ½æ²’æœ‰é€™äº›åƒæ•¸ï¼‰
            document.getElementById('showTitle').checked = params.get('st') !== '0';
            document.getElementById('showFooter').checked = params.get('sf') !== '0';
            document.getElementById('imageRounded').checked = params.get('br') !== '0';

            // è¢å¹•é‚Šç•Œ
            document.getElementById('screenPaddingVertical').value = params.get('spv') || '10';
            document.getElementById('screenPaddingHorizontal').value = params.get('sph') || '10';
            document.getElementById('screenPaddingVerticalValue').textContent = params.get('spv') || '10';
            document.getElementById('screenPaddingHorizontalValue').textContent = params.get('sph') || '10';

            // èƒŒæ™¯è¨­å®š
            const bgType = params.get('bt') || 'dots';
            document.querySelector(`input[name="bgType"][value="${bgType}"]`).checked = true;
            if (bgType === 'color') {
                document.getElementById('bgColorValue').value = params.get('bc') || '#FFFFFF';
            } else if (bgType === 'image') {
                document.getElementById('bgImageUrl').value = params.get('bi') ? decodeURIComponent(params.get('bi')) : '';
            }
            updateBgTypeUI(); // æ›´æ–° UI é¡¯ç¤º

            // åœ–ç‰‡é–“è·
            document.getElementById('imageGapVertical').value = params.get('igv') || '10';
            document.getElementById('imageGapHorizontal').value = params.get('igh') || '10';
            document.getElementById('imageGapVerticalValue').textContent = params.get('igv') || '10';
            document.getElementById('imageGapHorizontalValue').textContent = params.get('igh') || '10';

            // è§£ç¢¼åœ–ç‰‡ ID
            const imageIdsDecoded = params.get('id');
            if (imageIdsDecoded) {
                // æ¸…ç©ºç¾æœ‰åœ–ç‰‡åˆ—è¡¨å’Œé™£åˆ—
                document.getElementById('imageList').innerHTML = '';
                imageIds = [];

                const rawImageIds = imageIdsDecoded.split(',');
                const decodedImageIds = rawImageIds.map(id => {
                    // å¦‚æœæ˜¯ç·¨ç¢¼éçš„ URLï¼Œé€²è¡Œè§£ç¢¼
                    if (id.includes('%')) {
                        try {
                            const decodedId = decodeURIComponent(id);
                            // å¦‚æœè§£ç¢¼å¾Œæ˜¯å®Œæ•´ URLï¼Œè¿”å›è§£ç¢¼å¾Œçš„çµæœ
                            if (decodedId.startsWith('http')) {
                                return decodedId;
                            }
                        } catch (e) {
                            // è§£ç¢¼å¤±æ•—ï¼Œå¯èƒ½ä¸æ˜¯ç·¨ç¢¼çš„ URL
                        }
                    }
                    // å…¶ä»–æƒ…æ³è¿”å›åŸå§‹ ID
                    return id;
                });

                decodedImageIds.forEach(id => {
                    if (id.startsWith('http')) {
                        // å®Œæ•´ URLï¼Œç›´æ¥è¼‰å…¥
                        fetchImageFromUrl(id);
                    } else {
                        // Imgur IDï¼Œä½¿ç”¨ç¾æœ‰å‡½æ•¸
                        fetchImageFromImgur(id);
                    }
                });
            }

            updatePrimaryColor()
            updateSecondaryColor()

            // é—œé–‰ Modal
            const modalElement = document.querySelector('#decodeModal');
            var modal = bootstrap.Modal.getInstance(modalElement);
            modal.hide();
        }

        function fetchImageFromImgur(id) {
            const clientId = "a0a92307b538c2f";
            fetch(`https://api.imgur.com/3/image/${id}`, {
                headers: {
                    Authorization: "Client-ID " + clientId,
                }
            })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        const imgContainer = document.createElement('div');
                        imgContainer.classList.add('img-container', 'col-12', 'col-lg-4', 'col-md-6');
                        imgContainer.dataset.imageId = data.data.id;

                        const img = document.createElement('img');
                        img.src = data.data.link;
                        img.classList.add('image-preview');

                        // å‰µå»ºåˆªé™¤æŒ‰éˆ•
                        const deleteBtn = document.createElement('button');
                        deleteBtn.classList.add('delete-btn');
                        deleteBtn.innerHTML = '<i class="fas fa-times"></i>';
                        deleteBtn.onclick = () => {
                            imgContainer.remove();  // ç§»é™¤åœ–ç‰‡å®¹å™¨
                            const index = imageIds.indexOf(data.data.id);
                            if (index > -1) {
                                imageIds.splice(index, 1);  // ç§»é™¤åœ–ç‰‡ID
                            }
                            updateUrl();  // æ›´æ–° URL
                            updatePreview();  // æ›´æ–°é è¦½
                        };

                        // å°‡åœ–ç‰‡å’Œåˆªé™¤æŒ‰éˆ•æ·»åŠ åˆ°å®¹å™¨ä¸­
                        imgContainer.appendChild(img);
                        imgContainer.appendChild(deleteBtn);
                        document.getElementById('imageList').appendChild(imgContainer);
                    }
                })
                .catch(error => {
                    console.error("Error loading image from Imgur:", error);
                })
                .finally(() => {
                    updateUrl();
                    updatePreview();  // ç¢ºä¿æ›´æ–°é è¦½ï¼Œç„¡è«–åŠ è¼‰æˆåŠŸæˆ–å¤±æ•—
                });
        }

        // å¾å®Œæ•´ URL è¼‰å…¥åœ–ç‰‡
        function fetchImageFromUrl(imageUrl) {
            const imgContainer = document.createElement('div');
            imgContainer.classList.add('img-container', 'col-12', 'col-lg-4', 'col-md-6');
            imgContainer.dataset.imageId = imageUrl;

            const img = document.createElement('img');
            img.src = imageUrl;
            img.classList.add('image-preview');

            // å‰µå»ºåˆªé™¤æŒ‰éˆ•
            const deleteBtn = document.createElement('button');
            deleteBtn.classList.add('delete-btn');
            deleteBtn.innerHTML = '<i class="fas fa-times"></i>';
            deleteBtn.onclick = () => {
                imgContainer.remove();  // ç§»é™¤åœ–ç‰‡å®¹å™¨
                const index = imageIds.indexOf(imageUrl);
                if (index > -1) {
                    imageIds.splice(index, 1);  // ç§»é™¤åœ–ç‰‡ID
                }
                updateUrl();  // æ›´æ–° URL
                updatePreview();  // æ›´æ–°é è¦½
            };

            // å°‡åœ–ç‰‡å’Œåˆªé™¤æŒ‰éˆ•æ·»åŠ åˆ°å®¹å™¨ä¸­
            imgContainer.appendChild(img);
            imgContainer.appendChild(deleteBtn);
            document.getElementById('imageList').appendChild(imgContainer);

            updateUrl();
            updatePreview();
        }
    </script>
    <!-- <script src=script.js></script> -->
</body>

</html>